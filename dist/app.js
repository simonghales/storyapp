function freezeSite(){console.log("Freeze the site"),siteFrozen=!0;var e=$(window).scrollTop();$("#siteWrapper").attr("data-scroll",e).css("top","-"+e+"px"),calculateSiteHeight(),$("body").addClass("state__siteFrozen")}function calculateSiteHeight(){var e=$(window).height();$("body").css("height",e)}function unfreezeSite(){console.log("Unfreeze the site"),$("body").css("height","auto"),siteFrozen=!1,$("body").removeClass("state__siteFrozen");var e=$("#siteWrapper").attr("data-scroll");$("body").scrollTop($("body").scrollTop()+e)}function slugify(e){return e?e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""}function SignInCTRL(e,t,o,n){function a(){}function s(){t.closeThisDialog("signUp")}function r(t){console.log("Try to submit!"),t&&!l.states.busy&&(l.states.busy=!0,l.states.error=!1,o.post({username:l.input.username,password:l.input.password}).then(function(t){console.log("Response",t),o.setAuth(t.token,!0),e.$broadcast("user-authenticated"),i()},function(e){console.log("Response",e),l.states.busy=!1,l.states.error=!0}))}function i(){n.one("current").get().then(function(o){console.log("Got current user",o),n.storeUser(o.plain()),e.user=o.plain(),e.$broadcast("user-signedIn"),l.states.busy=!1,t.closeThisDialog()},function(e){console.log("Error getting current user",e),l.states.busy=!1,l.states.error=!0})}var l=this;l.states={busy:!1,error:!1,success:!1},l.input={username:"",password:""},l.activate=a,l.changeModal=s,l.submit=r,a()}function SignUpCTRL(e,t,o,n){function a(){}function s(){t.closeThisDialog("signIn")}function r(e){console.log("Try to submit!"),e&&!u.states.busy&&(u.states.busy=!0,u.states.error=!1,n.register.post({username:u.input.username,email:u.input.email,password:u.input.password,userprofile:{avatar_images:[],bio:""}}).then(function(e){console.log("Registered",e),i()},function(e){console.log("Failed to register",e),u.states.busy=!1,u.states.error=!0}))}function i(){o.post({username:u.input.username,password:u.input.password}).then(function(t){console.log("Response",t),o.setAuth(t.token,!0),e.$broadcast("user-authenticated"),l()},function(e){console.log("Response",e),u.states.busy=!1,u.states.error=!0})}function l(){n.one("current").get().then(function(o){console.log("Got current user",o),n.storeUser(o.plain()),e.$broadcast("user-signedIn"),u.states.busy=!1,t.closeThisDialog()},function(e){console.log("Error getting current user",e),u.states.busy=!1,u.states.error=!0})}var u=this;u.states={busy:!1,error:!1,success:!1},u.input={username:"",password:""},u.activate=a,u.changeModal=s,u.submit=r,a()}function SiteCTRL(e,t){function o(){}function n(){freezeSite();var e=t.signIn();e.closePromise.then(function(e){e.value&&"signUp"===e.value&&i.promptSignUp()})}function a(){freezeSite();var e=t.signUp();e.closePromise.then(function(e){e.value&&"signIn"===e.value&&i.promptSignIn()})}function s(){if(!e.states.signedIn)return i.promptSignIn();freezeSite();t.createStory()}function r(){e.$broadcast("user-signedOut")}var i=this;i.activate=o,i.promptSignIn=n,i.promptSignUp=a,i.promptCreateStory=s,i.signOut=r,o()}function StoryHomeCTRL(e,t){function o(){a.getStories()}function n(){a.states.loading=!0,e.getList({}).then(function(e){a.data.stories=e,a.states.loaded=!0,a.states.loading=!1,console.log("Loaded data",e)},function(e){console.log("Error",e),a.states.loaded=!0,a.states.loading=!1,a.states.error=!0})}var a=this;a.states={loading:!1,loaded:!1,error:!1},a.data={stories:null},a.activate=o,a.getStories=n,o()}function StoryCTRL(e,t,o,n,a){function s(){f.getStory()}function r(){f.states.loading=!0,o.one(t.id).get().then(function(e){console.log("Loaded data",e),e.deleted?(f.states.deleted=!0,console.log("Story is deleted")):(f.data.story=o.prep(e),g()),f.states.loaded=!0,f.states.loading=!1},function(e){console.log("Error",e),f.states.loaded=!0,f.states.loading=!1,f.states.error=!0})}function i(e){var a=n.newPageTemplate(t.id);a=o.prepPage(a),f.data.story.pages[e+1]&&f.data.story.pages[e+1].id&&(a.insert_before=f.data.story.pages[e+1].id),f.data.story.pages.splice(e+1,0,a)}function l(){freezeSite(),data=f.data.story;a.deleteStory(data)}function u(e){f.data.story.pages.splice(e,1),console.log("I should remove page at index:",e)}function c(){f.states.editing=!f.states.editing}function p(e,t,o){f.states.textEditorOpen=!0,f.editingElement=e,f.editingPagePending=t,f.editingOffset=o,console.log("Editing new element",f.editingElement,f.editingPagePending)}function g(){d()}function d(){e.user&&(f.data.story.author.id==e.user.id?(f.states.owner=!0,f.states.editing=!0):(f.states.owner=!1,f.states.editing=!1))}var f=this;f.states={deleted:!1,loading:!1,loaded:!1,error:!1,owner:!1,editing:!1,textEditorOpen:!1},f.data={story:null},f.editingOffset=null,f.editingPagePending=null,f.editingElement=null,f.editorOptions={cancel:".__noDrag",containment:"window"},f.activate=s,f.getStory=r,f.addPage=i,f.deleteStoryPrompt=l,f.removePage=u,f.toggleEditing=c,f.editElement=p,s()}function StoryPageCTRL(e,t,o,n,a){function s(){m.page.defaultTemplate&&(f(),m.page.defaultTemplate=null)}function r(){m.states.pendingChanges=!0}function i(){freezeSite();var e={image:m.page.background_image_urls[0]},t=a.uploadImage(e);t.closePromise.then(function(e){e&&e.value&&e.value.id&&g(e.value)})}function l(e){return"top"==e?void(m.page.measurements_prepped.text_vertical="top"):"bottom"==e?void(m.page.measurements_prepped.text_vertical="bottom"):"left"==e?void(m.page.measurements_prepped.text_horizontal="left"):"right"==e?void(m.page.measurements_prepped.text_horizontal="right"):void 0}function u(e){freezeSite();var t=m.page,o=a.deleteStoryPage(t);o.closePromise.then(function(t){t&&t.value&&"deleted"==t.value&&p(e)}),console.log("Delete page and pass",m.page)}function c(){m.page=o.prepSavePage(m.page),d(),console.log("Prep page",o.prepSavePage(m.page))}function p(t){e.$parent.story.removePage(t)}function g(e){console.log("Updated page",m.page),m.page.background_image_urls[0]=e,m.page.background_images[0]=e.id,d()}function d(){if(!m.states.updating){m.states.updating=!0,console.log("Gonna save page",m.page);var e=t.restangularizeElement(null,m.page,"api/storypages");e.put().then(function(e){console.log("Successfully updated!",e),m.states.pendingChanges=!1,m.states.updating=!1},function(e){console.log("Failed to updated",e),m.states.updating=!1})}}function f(){n.post(m.page).then(function(e){m.page.id=e.id,console.log("Created page",e)},function(e){console.log("Error",e)})}var m=this;m.states={pendingChanges:!1,updating:!1},m.page=e.page,m.activate=s,m.pendingChanges=r,m.moveText=l,m.changeImage=i,m.deletePage=u,m.savePage=c,s(),m.widthConfig={handles:"w, e",resize:function(e,t){var o=t.originalSize.width+2*(t.size.width-t.originalSize.width);$(this).width("auto").position({of:$(this).parent(),my:"center center",at:"center center"}),$(this).css({left:"auto",right:"auto",width:"auto","max-width":o}),t.size.width=o},stop:function(t,o){console.log("Finished resizing",o.size.width),m.page.measurements_prepped.container_width=o.size.width,m.states.pendingChanges=!0,e.$apply()}},m.offsetsConfig={handles:"all",resize:function(e,t){var o=$(this).parent().height(),n=$(this).parent().width();$(this).width("auto").height("auto").position({of:$(this).parent(),my:"center center",at:"center center"});var a=$(this).css("left"),s=$(this).css("top");if(console.log("Original offsets",a,s),isNaN(t.size.width)||t.size.width==t.originalSize.width)var r=t.originalSize.width;else{var r=t.size.width+(t.size.width-t.originalSize.width)/2,a=(n-r)/2;console.log("Fixed up horizontal offset",a,r,t.size.width,t.originalSize.width)}if(isNaN(t.size.height)||t.size.height==t.originalSize.height)var i=t.originalSize.height;else{var i=t.size.height+(t.size.height-t.originalSize.height)/2,s=(o-i)/2;console.log("Fixed up vertical offset",s,i,t.size.height,t.originalSize.height)}10>a&&(a=10),10>s&&(s=10),t.size.height="auto",t.size.width="auto",$(this).css({top:s,bottom:s,left:a,right:a}),t.size.verticalOffset=s,t.size.horizontalOffset=a,console.log("Resized",s,a)},stop:function(t,o){var n=o.size.verticalOffset,a=o.size.horizontalOffset;m.page.measurements_prepped.horizontal_offset=a,m.page.measurements_prepped.vertical_offset=n,m.states.pendingChanges=!0,console.log("Final",n,a),e.$apply()}},m.textConfig={handles:"all",resize:function(e,t){$(this).css({top:"",bottom:"",left:"",right:""})},stop:function(t,o){m.page.measurements_prepped.text_width=o.size.width,m.page.measurements_prepped.text_height=o.size.height,m.states.pendingChanges=!0,e.$apply()}}}function CreateStoryCTRL(e,t,o,n,a,s,r,i){function l(){}function u(e){e&&!g.states.image.busy&&(g.states.image.busy=!0,g.states.image.prepping=!0,g.states.image.processing=!1,g.states.image.uploading=!1,r.resizeImage(e,function(t){var n=r.dataURItoBlob(t);console.log("File",e,n),g.states.image.prepping=!1,g.states.image.uploading=!0;var s=a.upload({url:i+"api/image/.json",file:{original:n},fields:{remote_url:""},headers:{Authorization:o.defaults.headers.common.Authorization}});s.progress(function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total)),g.states.image.uploadProgress=e.progress,console.log("Progress: "+e.progress),100==e.progress&&(g.states.image.uploading=!1,g.states.image.processing=!0)}),s.then(function(e){console.log("Succes??",e),g.input.imageObj=e.data,g.states.image.prepping=!1,g.states.image.processing=!1,g.states.image.uploading=!1,g.states.image.busy=!1},function(e){e.status>0&&(console.log("Something went wrong :("),g.states.image.prepping=!1,g.states.image.processing=!1,g.states.image.uploading=!1,g.states.image.busy=!1)})}))}function c(){return g.input.title&&g.input.description&&g.input.imageObj?!0:!1}function p(){c()&&!g.states.busy&&(g.states.busy=!0,s.post({title:g.input.title,description:g.input.description,profile_images:[g.input.imageObj.id],banner_images:[],listed:!0}).then(function(e){console.log("Created story",e),g.states.busy=!1,n.path("/s/"+e.id+"/"+slugify(e.title)),t.closeThisDialog()},function(e){console.log("Error",e),g.states.busy=!1,g.states.error=!0}),console.log("Submit form!"))}var g=this;g.states={busy:!1,error:!1,success:!1,image:{busy:!1,prepping:!1,uploading:!1,processing:!1,error:!1,uploadProgress:0}},g.input={title:"",description:"",imageObj:null},g.activate=l,g.uploadImage=u,g.isValidForm=c,g.submit=p,l()}function StoryElementCTRL(e,t){function o(){}function n(t){var o={x:t.pageX,y:t.pageY};e.editElement(s.element,e.pending,o)}function a(){return{color:s.element.color,"font-size":s.element.font_size,"text-align":s.element.text_align}}var s=this;s.element=e.element,s.activate=o,s.editElement=n,s.setStyles=a,o()}var siteFrozen=!1;angular.module("app",["app.filters","app.directives","app.services","app.routes","app.account","app.site","app.user","app.story","app.image","ui.router","mp.colorPicker","offClick","720kb.tooltips","ngDialog","ngCookies","ui.router","ngFileUpload","restangular","ngAnimate","templates","contenteditable"]),angular.module("app.filters",[]),angular.module("app.directives",[]),angular.module("app.services",[]),angular.module("app.routes",["ui.router"]),angular.module("app.account",["app.account.controllers","app.account.services"]),angular.module("app.account.controllers",[]),angular.module("app.account.services",[]),angular.module("app.site",["app.site.controllers","app.site.directives"]),angular.module("app.site.controllers",[]),angular.module("app.site.directives",[]),angular.module("app.user",["app.user.controllers","app.user.services"]),angular.module("app.user.controllers",[]),angular.module("app.user.services",[]),angular.module("app.story",["app.story.services","app.story.controllers","app.story.directives"]),angular.module("app.story.services",[]),angular.module("app.story.controllers",[]),angular.module("app.story.directives",[]),angular.module("app.image",["app.image.services","app.image.controllers"]),angular.module("app.image.services",[]),angular.module("app.image.controllers",[]),angular.module("templates",[]),angular.module("app.routes").config(["$stateProvider","$locationProvider","$urlRouterProvider",function(e,t,o){o.otherwise("/"),e.state("home",{url:"/",templateUrl:"partials/_home_dev.html",activeTab:"home",controller:"StoryHomeCTRL",controllerAs:"home"}).state("story",{url:"/s/:id/:slug",templateUrl:"partials/story/_story.html",activeTab:"story",controller:"StoryCTRL",controllerAs:"story"})}]),angular.module("app").constant("API_URL","https://morning-mountain-1547.herokuapp.com/"),angular.module("app").config(["RestangularProvider","API_URL",function(e,t){e.setBaseUrl(t),e.setRequestSuffix("/.json"),e.addResponseInterceptor(function(e,t,o,n,a,s){var r;return"getList"===t?(r=e.results,r.meta={count:e.count,next:e.next,previous:e.previous}):r=e,r})}]),angular.module("app").run(["$rootScope","$http","$state","$cookies","ngDialog","AuthenticationResource","UserResource",function(e,t,o,n,a,s,r){e.states={signedIn:!1,admin:!0,stateChanging:!1},e.user=null,e.containerClass="page__loading",function(){if(s.isAuth()){var t=s.getAuth();s.setAuth(t),e.states.signedIn=!0,r.isStoredUser()&&(e.user=r.getStoredUser(),console.log("Retrieved user from cookie",e.user)),r.getCurrentUserAndStore()}else e.states.signedIn=!1}(),e.$on("$stateChangeStart",function(t,o,n,s,r){e.states.stateChanging=!0,a.closeAll()}),e.$on("$stateChangeSuccess",function(t,o,n,a,s){e.containerClass="page__"+o.activeTab,e.states.stateChanging=!1}),e.$on("user-signedIn",function(){e.states.signedIn=!0,o.go(o.current,{},{reload:!0})}),e.$on("user-signedOut",function(){e.states.signedIn=!1,s.clearAuth(),o.go(o.current,{},{reload:!0})})}]),angular.module("app.filters").filter("slugify",["$sce",function(e){return function(e){return e?slugify(e):void 0}}]),angular.module("app.directives").directive("backImg",function(){return function(e,t,o){o.$observe("backImg",function(){n()});var n=function(){var e=o.backImg;if(e){t.addClass("__providedImage"),t.closest(".story-page").addClass("state__loading");var n=$("<img />");n.attr("src",e),n.load(function(){t.css({"background-image":"url("+e+")"}),t.removeClass("__noImage"),t.closest(".story-page").removeClass("state__loading").addClass("state__loaded")})}else t.addClass("__noImage")};n()}}),function(){"use strict";function e(e){function t(){return e.open({template:"partials/account/_signIn.html",className:"yepDialog-theme-default",controller:"SignInCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}function o(){return e.open({template:"partials/account/_signUp.html",className:"yepDialog-theme-default",controller:"SignUpCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}function n(){return e.open({template:"partials/story/_createStory.html",className:"yepDialog-theme-default yepDialog-theme--wide",controller:"CreateStoryCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}function a(t){return e.open({template:"partials/image/_uploadImage.html",className:"yepDialog-theme-default yepDialog-theme--wide __fullWidth",data:t,controller:"UploadImageCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}function s(t){return e.open({template:"partials/story/_deleteStory.html",className:"yepDialog-theme-default",data:t,controller:"DeleteStoryCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}function r(t){return e.open({template:"partials/story/_deletePage.html",className:"yepDialog-theme-default",data:t,controller:"DeleteStoryPageCTRL",controllerAs:"modalVM",preCloseCallback:function(){unfreezeSite()}})}var i={};return i.signIn=t,i.signUp=o,i.uploadImage=a,i.createStory=n,i.deleteStory=s,i.deleteStoryPage=r,i}angular.module("app.services").factory("ModalsService",e),e.$inject=["ngDialog"]}(),angular.module("app.directives").directive("dragMe",function(){return{restrict:"A",link:function(e,t,o){var n=e.$eval(o.dragOptions);console.log("Provided options",n),t.draggable(n)}}}),function(){"use strict";function e(){function e(e,t){var o=new FileReader;o.onloadend=function(){var e=new Image;e.src=o.result,e.onload=function(){var o=1920,n=1920,a=e.width,s=e.height;a>s?a>o&&(s*=o/a,a=o):s>n&&(a*=n/s,s=n);var r=document.createElement("canvas");r.width=a,r.height=s;var i=r.getContext("2d");i.drawImage(this,0,0,a,s);var l=r.toDataURL("image/jpeg");t(l)}},o.readAsDataURL(e)}function t(e){for(var t=atob(e.split(",")[1]),o=new ArrayBuffer(t.length),n=new Uint8Array(o),a=0;a<t.length;a++)n[a]=t.charCodeAt(a);return new Blob([o],{type:"image/jpeg"})}var o={};return o.resizeImage=e,o.dataURItoBlob=t,o}angular.module("app.image.services").factory("ImageService",e),e.$inject=[]}(),function(){function e(e,t,o,n,a){function s(){l.data.image&&(l.image=l.data.image)}function r(){e.closeThisDialog(l.image)}function i(e){e&&!l.states.busy&&(l.states.busy=!0,l.states.prepping=!0,l.states.processing=!1,l.states.uploading=!1,n.resizeImage(e,function(s){var r=n.dataURItoBlob(s);l.states.prepping=!1,l.states.uploading=!0;var i=o.upload({url:a+"api/image/.json",file:{original:r},fields:{remote_url:""},headers:{Authorization:t.defaults.headers.common.Authorization}});i.progress(function(t){e.progress=Math.min(100,parseInt(100*t.loaded/t.total)),l.states.uploadProgress=e.progress,100==e.progress&&(l.states.uploading=!1,l.states.processing=!0)}),i.then(function(e){l.image=e.data,l.states.prepping=!1,l.states.processing=!1,l.states.uploading=!1,l.states.busy=!1},function(e){e.status>0&&(l.states.prepping=!1,l.states.processing=!1,l.states.uploading=!1,l.states.busy=!1)})}))}var l=this;l.states={busy:!1,error:!1,prepping:!1,processing:!1,uploading:!1,uploadProgress:0},l.data=e.ngDialogData,l.image=null,l.activate=s,l.confirm=r,l.uploadImage=i,s()}angular.module("app.image.controllers").controller("UploadImageCTRL",e),e.$inject=["$scope","$http","Upload","ImageService","API_URL"]}(),angular.module("app.account.controllers").controller("SignInCTRL",SignInCTRL),SignInCTRL.$inject=["$rootScope","$scope","AuthenticationResource","UserResource"],angular.module("app.account.controllers").controller("SignUpCTRL",SignUpCTRL),SignUpCTRL.$inject=["$rootScope","$scope","AuthenticationResource","UserResource"],function(){"use strict";function e(e,t,o){function n(){return!!t.get("JWT")}function a(){return t.get("JWT")?t.get("JWT"):null}function s(t,o){e.defaults.headers.common.Authorization="JWT "+t,e.defaults.headers.common["Content-Type"]="application/json",o&&l.storeAuth(t)}function r(e){t.put("JWT",e)}function i(){e.defaults.headers.common.Authorization=null,t.remove("JWT")}var l=o.service("api-token-auth");return l.isAuth=n,l.getAuth=a,l.setAuth=s,l.storeAuth=r,l.clearAuth=i,l}angular.module("app.account.services").factory("AuthenticationResource",e),e.$inject=["$http","$cookies","Restangular"]}(),angular.module("app.site.controllers").controller("SiteCTRL",SiteCTRL),SiteCTRL.$inject=["$rootScope","ModalsService"],function(){"use strict";function e(){var e={restrict:"E",templateUrl:"partials/_header.html",replace:!0};return e}angular.module("app.site.directives").directive("siteHeader",e)}(),function(){"use strict";function e(e,t){function o(){r.one("current").get().then(function(e){r.storeUser(e.plain())},function(e){console.log("Failed to get current user",e)})}function n(){return!!e.get("user")}function a(){return e.get("user")?JSON.parse(e.get("user")):null}function s(t){e.put("user",JSON.stringify(t))}var r=t.service("api/users");return r.register=t.service("api/users/create"),r.getCurrentUserAndStore=o,r.isStoredUser=n,r.getStoredUser=a,r.storeUser=s,r}angular.module("app.user.services").factory("UserResource",e),e.$inject=["$cookies","Restangular"]}(),function(){"use strict";function e(e){function t(e){for(var t=0,o=e.pages.length;o>t;t++){var n=e.pages[t];n=s(n)}return e}function o(e){return s(e)}function n(e){return e.measurements=JSON.stringify(e.measurements_prepped),e.elements=angular.toJson(e.elements_prepped),e}function a(e){return angular.toJson(e)}function s(e){return e.test="boop",e.measurements_prepped=r(e.measurements),e.elements_prepped=i(e.elements),e}function r(e){var t={container_width:"804px",vertical_offset:"50px",horizontal_offset:"80px",text_width:"300px",text_height:"350px",text_vertical:"top",text_horizontal:"left"};if(e){var o=JSON.parse(e);o.container_width&&(t=JSON.parse(e))}return t}function i(e){var t=[],o='[{"text":"Default ipsum woopum","font_size":"42px","color":"#000000","text_align":"left"},{"text":"Bananananana","font_size":"22px","color":"#004892","text_align":"center"},{"text":"Small writing!","font_size":"14px","color":"#000000","text_align":"right"}]';return t=e?JSON.parse(e):JSON.parse(o)}var l=e.service("api/stories");return l.prep=t,l.prepPage=o,l.stringifyElements=a,l.prepSavePage=n,l}angular.module("app.story.services").factory("StoryResource",e),e.$inject=["Restangular"]}(),angular.module("app.story.controllers").controller("StoryHomeCTRL",StoryHomeCTRL),StoryHomeCTRL.$inject=["StoryResource","Restangular"],angular.module("app.story.controllers").controller("StoryCTRL",StoryCTRL),StoryCTRL.$inject=["$rootScope","$stateParams","StoryResource","PageResource","ModalsService"],function(){"use strict";function e(){var e={restrict:"E",templateUrl:"partials/story/_storyPreview.html",replace:!0};return e}angular.module("app.story.directives").directive("storyPreview",e)}(),function(){"use strict";function e(e){function t(e){return{id:(new Date).getUTCMilliseconds()+Math.floor(9001*Math.random()),defaultTemplate:!0,story:e,background_images:[],background_image_urls:[],measurements:"[]",background_colour:"#E0E0E0",element_groups:[],elements:""}}var o=e.service("api/storypages");return o.newPageTemplate=t,o}angular.module("app.story.services").factory("PageResource",e),e.$inject=["Restangular"]}(),angular.module("app.story.controllers").controller("StoryPageCTRL",StoryPageCTRL),StoryPageCTRL.$inject=["$scope","Restangular","StoryResource","PageResource","ModalsService"],function(){function e(e,t,o,n){function a(){}function s(){r.states.busy||(r.states.busy=!0,r.states.error=!1,n.one(r.page.id).remove().then(function(){r.states.busy=!1,t.closeThisDialog("deleted")},function(e){console.log("Error",e),r.states.error=!0,r.states.busy=!1}))}var r=this;r.states={busy:!1,error:!1,success:!1},r.page=t.ngDialogData,r.activate=a,r.confirm=s,a()}angular.module("app.story.controllers").controller("DeleteStoryPageCTRL",e),e.$inject=["$rootScope","$scope","$location","PageResource"]}(),function(){"use strict";function e(){var e={restrict:"E",controller:"StoryPageCTRL",controllerAs:"pageVM",templateUrl:"partials/story/_storyPage.html",replace:!0};return e}angular.module("app.story.directives").directive("storyPage",e)}(),function(){function e(e,t,o,n){function a(){}function s(e){freezeSite();var t={image:e.background_image_urls[0]},o=n.uploadImage(t);o.closePromise.then(function(t){t&&t.value&&t.value.id&&u(e,t.value)})}function r(e,t){freezeSite();var o=e,a=n.deleteStoryPage(o);a.closePromise.then(function(e){e&&e.value&&"deleted"==e.value&&l(t)}),console.log("Delete page and pass",e)}function i(e){c(e)}function l(t){e.$parent.$parent.story.removePage(t)}function u(e,t){console.log("Updated page",e),e.background_image_urls[0]=t,e.background_images[0]=t.id,c(e)}function c(e){var o=t.restangularizeElement(null,e,"api/storypages");o.put().then(function(e){console.log("Successfully updated!",e)},function(e){console.log("Failed to updated",e)})}var p=this;p.activate=a,p.changeImage=s,p.deletePage=r,p.savePage=i,a()}angular.module("app.story.controllers").controller("PageOptionsCTRL",e),e.$inject=["$scope","Restangular","PageResource","ModalsService"]}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"partials/story/_storyPageOptions.html",replace:!0};return e}angular.module("app.story.directives").directive("pageOptions",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"partials/story/_storyMenu.html",replace:!0};return e}angular.module("app.story.directives").directive("storyMenu",e)}(),function(){function e(e,t,o,n){function a(){}function s(){r.states.busy||(r.states.busy=!0,r.states.error=!1,r.story.remove().then(function(){r.states.busy=!1,o.path("/"),t.closeThisDialog()},function(e){console.log("Error",e),r.states.error=!0,r.states.busy=!1}))}var r=this;r.states={busy:!1,error:!1,success:!1},r.story=t.ngDialogData,console.log("Data",r.story),r.activate=a,r.confirm=s,a()}angular.module("app.story.controllers").controller("DeleteStoryCTRL",e),e.$inject=["$rootScope","$scope","$location","StoryResource"]}(),angular.module("app.story.controllers").controller("CreateStoryCTRL",CreateStoryCTRL),CreateStoryCTRL.$inject=["$rootScope","$scope","$http","$location","Upload","StoryResource","ImageService","API_URL"],function(){"use strict";function e(){var e={restrict:"A",scope:{pageWidth:"=",owner:"=",editing:"=",config:"="}};return e.link=function(e,t,o){t.css({"max-width":e.pageWidth}),e.owner&&(t.resizable(e.config),e.editing||t.resizable("disable"),e.$watch("editing",function(e,o){e?t.resizable("enable"):t.resizable("disable")},!0))},e}angular.module("app.story.directives").directive("pageWidth",e)}(),function(){"use strict";function e(){var e={restrict:"A",scope:{pageVertical:"=",pageHorizontal:"=",owner:"=",editing:"=",config:"="}};return e.link=function(e,t,o){t.css({top:e.pageVertical,bottom:e.pageVertical,left:e.pageHorizontal,right:e.pageHorizontal}),e.owner&&(t.resizable(e.config),e.editing||(console.log("Disable boop woop!"),t.resizable("disable")),e.$watch("editing",function(e,o){e?t.resizable("enable"):t.resizable("disable")},!0))},e}angular.module("app.story.directives").directive("pageOffsets",e)}(),function(){"use strict";function e(){var e={restrict:"E",templateUrl:"partials/story/_storyText.html",replace:!0,scope:{horizontal:"=",vertical:"=",elements:"=",measurements:"=",config:"=",owner:"=",editing:"=",pending:"=",editElement:"="}};return e.link=function(e,t,o){function n(){console.log("Calculate positions"),t.removeClass("posHorizontal__left posHorizontal__right posVertical__top posVertical__bottom").addClass("posHorizontal__"+e.horizontal).addClass("posVertical__"+e.vertical)}n(),t.css({width:e.measurements.text_width,height:e.measurements.text_height}),e.moveText=function(t,o){console.log("Move text"),"v"==o?e.vertical=t:e.horizontal=t,n(),e.pending()},e.owner&&(t.resizable(e.config),e.editing||t.resizable("disable"),e.$watch("editing",function(e,o){e?t.resizable("enable"):t.resizable("disable")},!0))},e}angular.module("app.story.directives").directive("storyText",e)}(),function(){"use strict";function e(){var e={restrict:"E",controller:"TextEditorCTRL",controllerAs:"textEditor",templateUrl:"partials/story/_storyTextEditor.html",scope:{visible:"=",pending:"=",editingElement:"=",offset:"="}};return e.link=function(e,t,o){function n(){e.visible?t.show():t.hide()}console.log("Text editor",e);var a=t.width(),s=e.offset.y+15,r=e.offset.x-a-15;10>s&&(s=10),10>r&&(r=10),t.css({top:s+"px",left:r+"px"}),e.$watch("visible",function(t,o){console.log("Visible changed",e.visible,t),n()},!0),n()},e}angular.module("app.story.directives").directive("textEditor",e)}(),function(){function e(e){function t(){e.$watch("visible",function(){r.states.open=e.visible}),e.$watch("editingElement",function(){r.element=e.editingElement},!0),e.$watch("editingElement.color",function(t,o){o&&r.states.open&&t!==o&&e.pending()},!0)}function o(){r.states.dropdown_fontSize=!r.states.dropdown_fontSize}function n(){r.states.dropdown_textAlign=!r.states.dropdown_textAlign}function a(t,o,n){r.element[o]=t,r.states[n]=!1,e.pending()}function s(){console.log("Hide the editor"),e.editingElement=null,r.element=null,r.states.open=!1,e.visible=!1}var r=this;r.states={open:!1},r.element=e.editingElement,r.data={styles:{color:"#000000",fontSize:"18px",textAlign:"left"}},r.states={dropdown_fontSize:!1,dropdown_textAlign:!1},r.options={fontSize:["12px","14px","16px","18px","20px","22px","24px","26px","28px","30px"],textAlign:["left","right","center"]},r.activate=t,r.toggleDropdownFont=o,r.toggleDropdownAlign=n,r.selectOption=a,r.hide=s,t()}angular.module("app.story.controllers").controller("TextEditorCTRL",e),e.$inject=["$scope"]}(),angular.module("app.story.controllers").controller("StoryElementCTRL",StoryElementCTRL),StoryElementCTRL.$inject=["$scope","StoryResource"],function(){"use strict";function e(){var e={restrict:"E",controller:"StoryElementCTRL",controllerAs:"elementVM",templateUrl:"partials/story/_storyElement.html",replace:!0,scope:{pending:"=",element:"=",editElement:"="}};return e.link=function(e,t,o){e.$watch("element.text",function(t,o){t!==o&&e.pending()},!0)},e}angular.module("app.story.directives").directive("storyElement",e)}();
angular.module("templates").run(["$templateCache", function($templateCache) {$templateCache.put("partials/_create.html","<section class=\"page__create\" ng-class=\"{\'state__busy\' : create.states.busy}\">\r\n    <h2 class=\"title__large\">Create your Story</h2>\r\n    <form name=\"createForm\" class=\"simpleForm\" novalidate ng-submit=\"create.createStory(createForm.$valid);\">\r\n        <section class=\"formSection\">\r\n            <figure class=\"uploadStoryImage\" ng-class=\"{ \'state__empty\' : !create.form.image }\" ng-click=\"create.uploadImage();\">\r\n                <div class=\"bgImg__emptyPlaceholder bgImg __noImage\" back-img=\"{{create.form.image}}\">\r\n\r\n                </div>\r\n                <div class=\"uploadPrompt\">\r\n                    <span class=\"icon icon-picture\"></span> <span class=\"text\">Upload a Preview Image</span>\r\n                </div>\r\n            </figure>\r\n        </section>\r\n        <section class=\"formBody\">\r\n            <section class=\"formSection flexInput\">\r\n                <label class=\"label__dark\" for=\"\">Story Title</label>\r\n                <input class=\"input__dark title\" type=\"text\" ng-model=\"create.form.title\" required maxlength=\"50\"/>\r\n            </section>\r\n            <section class=\"formSection flexInput\">\r\n                <label class=\"label__dark\" for=\"\">Description</label>\r\n                <textarea class=\"input__dark\" ng-model=\"create.form.desc\" required maxlength=\"500\"></textarea>\r\n            </section>\r\n            <section class=\"formSection align__center\">\r\n                <button class=\"button button__major button__blue button__bigger button__full\" ng-class=\"{ \'state__invalid\' : createForm.$invalid }\" type=\"submit\">\r\n                    <span class=\"hide__busy __inline\">Create Story</span>\r\n                    <span class=\"show__busy __inline\">...processing...</span>\r\n                </button>\r\n            </section>\r\n        </section>\r\n    </form>\r\n</section>");
$templateCache.put("partials/_header.html","<header class=\"header__main\">\r\n    <div class=\"__maxSize clearfix\">\r\n        <h1><a href=\"#/\">yep.is</a></h1>\r\n        <div class=\"header-options\">\r\n            <button class=\"btn btn--create btn__simple\"\r\n                    ng-click=\"siteVM.promptCreateStory();\">\r\n                <span>Create Story</span>\r\n                <span class=\"icon icon-picture\"></span>\r\n            </button>\r\n            <button ng-click=\"siteVM.promptSignIn();\"\r\n                    class=\"btn btn--create btn__simple __plain show__signedOut __inline\">\r\n                <span>Sign In</span>\r\n            </button>\r\n            <button ng-click=\"siteVM.promptSignUp();\"\r\n                    class=\"btn btn--create btn__simple __plain __noOutline show__signedOut __inline\">\r\n                <span>Not Registered?</span>\r\n            </button>\r\n            <a ng-click=\"siteVM.signOut();\" class=\"header__userOptions show__signedIn __inline\">\r\n                <figure class=\"user__thumb\" style=\"background-image:url(images/simon.jpg);\"></figure>\r\n            </a>\r\n        </div>\r\n    </div>\r\n</header>");
$templateCache.put("partials/_home.html","<section class=\"homePage clearfix\">\r\n    <section class=\"sideMenu\" ng-controller=\"MenuCTRL as menu\">\r\n        <section class=\"menuUserAccount show__loggedIn\">\r\n            <figure class=\"user-img user-img__medium __clickable\" style=\"background-image:url(images/simon.jpg);\" ng-click=\"menu.states.userDropdownOpen = !menu.states.userDropdownOpen\"></figure>\r\n            <div class=\"userAccountDropdown\" ng-show=\"menu.states.userDropdownOpen\" off-click=\"menu.states.userDropdownOpen = false\" off-click-if=\"menu.states.userDropdownOpen\" ng-click=\"menu.states.userDropdownOpen = false\">\r\n                <ul>\r\n                    <li>\r\n                        <a class=\"option option__profile\" href=\"\">\r\n                            <h3 ng-bind=\"$root.globals.currentUser.username\"></h3>\r\n                            <h4>view profile</h4>\r\n                        </a>\r\n                    </li>\r\n                    <li>\r\n                        <a class=\"option\" ng-click=\"site.signOut();\">\r\n                            Sign Out\r\n                        </a>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </section>\r\n        <section class=\"homeIntro\">\r\n            <h1><a href=\"#/\"><span>yep</span>.is</a></h1>\r\n            <h3>Create and share your stories</h3>\r\n        </section>\r\n        <section class=\"menuUserOptions\">\r\n            <div class=\"menuUserOptions-accounts buttons_half show__signedOut\">\r\n                <div class=\"buttonWrapper\">\r\n                    <button class=\"button__major\" ng-click=\"site.openRegister();\">Sign Up</button>\r\n                </div>\r\n                <div class=\"buttonWrapper\">\r\n                    <button class=\"button__major button__clear\" ng-click=\"site.openSignIn();\">Log In</button>\r\n                </div>\r\n            </div>\r\n            <a href=\"#/create\" class=\"button button__major button__blue button__bigger homeCreateLink\">Create a Story</a>\r\n        </section>\r\n    </section>\r\n    <div class=\"mainBodyWrapper\" ui-view=\"home\">\r\n    </div>\r\n</section>");
$templateCache.put("partials/_home_dev.html","<section class=\"page__home\" ng-class=\"{ \'state__loading\' : home.states.loading }\">\r\n    <section class=\"homeBody\">\r\n        <article class=\"featuredStory parallax\">\r\n            <a href=\"#/s/L31AK/india-2015\">\r\n                <div class=\"bgWrapper parallax__layer parallax__layer--back bgImg\"\r\n                     style=\"background-image:url(http://i.imgur.com/bFkcFM2.jpg);\">\r\n                    <div class=\"anotherWrapper\">\r\n                        <!--<img class=\"bg\" src=\"images/boats.jpg\" alt=\"Story Image\"/>-->\r\n                    </div>\r\n                </div>\r\n                <div class=\"contentWrapper parallax__layer parallax__layer--base\">\r\n                    <div class=\"content\">\r\n                        <h2>India 2015</h2>\r\n                    </div>\r\n                </div>\r\n            </a>\r\n        </article>\r\n        <section class=\"homeStories\">\r\n            <div class=\"__maxSize\">\r\n                <ul class=\"list__threeCol show__loading\">\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                    <li>\r\n                        <story-preview class=\"state__placeholder\"></story-preview>\r\n                    </li>\r\n                </ul>\r\n                <ul class=\"list__threeCol hide__loading\">\r\n                    <li ng-repeat=\"story in home.data.stories\">\r\n                        <story-preview></story-preview>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </section>\r\n    </section>\r\n</section>");
$templateCache.put("partials/_home_stories.html","<section class=\"mainBody\" ng-controller=\"StoriesList as storiesList\" ng-class=\"{ \'state__loading\' : storiesList.states.loading }\">\r\n    <section class=\"storyPreviews show__loading\">\r\n        <div class=\"previewRow\">\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper grid__big __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n        </div>\r\n        <div class=\"previewRow\">\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper grid__big __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n        </div>\r\n        <div class=\"previewRow\">\r\n            <div class=\"storyPreviewWrapper grid__big __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n        </div>\r\n        <div class=\"previewRow\">\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n            <div class=\"storyPreviewWrapper grid__big __placeholder\">\r\n                <article class=\"storyPreview\">\r\n                    <a class=\"storyPreview-link\">\r\n                        <div class=\"storyPreview-img\">\r\n                            <div class=\"storyPreview-shade\"></div>\r\n                            <div class=\"storyPreview-title\">\r\n                                <h3></h3>\r\n                            </div>\r\n                        </div>\r\n                    </a>\r\n                    <div class=\"storyPreview-details\">\r\n                        <a class=\"user\">\r\n                            <figure class=\"user-img\"></figure>\r\n                            <span></span>\r\n                        </a>\r\n                    </div>\r\n                </article>\r\n            </div>\r\n        </div>\r\n    </section>\r\n    <section class=\"storyPreviews hide__loading\">\r\n        <div class=\"previewRow cols__{{::row.length}}\" ng-repeat=\"row in ::storiesList.dataRows\">\r\n            <story-preview ng-repeat=\"story in ::row\"></story-preview>\r\n        </div>\r\n    </section>\r\n</section>\r\n");
$templateCache.put("partials/_old_storyPage.html","<div class=\"storyPageWrapper\" data-ng-controller=\"PageCTRL as page\"> <!-- move back to article object -->\r\n    <article class=\"storyPage\" back-img=\"{{page.data.background_image_urls[0].original}}\" ng-style=\"page.setPageCSS();\">\r\n        <div class=\"storyContainer storyContainer__resizable size__default\" resizable resizable-config=\"page.resizableContainer.configuration\" ng-style=\"{ \'max-width\' : page.safeData.measurements.containerWidth }\">\r\n            <div class=\"storyContainer-slider storyContainer-slider--left\"></div>\r\n            <div class=\"storyContainer-slider storyContainer-slider--right\"></div>\r\n            <div class=\"storyPadding padding__default\">\r\n                <div class=\"storyContent storyContent__resizable\" resizable resizable-config=\"page.resizableContent.configuration\" ng-style=\"page.setContentCSS();\">\r\n                    <div class=\"storyText storyText__resizable\" resizable resizable-config=\"page.resizableText.configuration\" position-vertical=\"page.data.measurements.positionVertical\" position-horizontal=\"page.data.measurements.positionHorizontal\" ng-class=\"page.setPositionClasses();\" ng-style=\"page.setTextDimensions();\">\r\n                        <div class=\"headingContainer\">\r\n                            <h2 class=\"heading hide__editing\" ng-style=\"page.setHeadingStyles();\">{{page.data.headingDetails.text}}</h2>\r\n                            <div class=\"inputWrapper show__editing\">\r\n                                <div class=\"storyUi-inlineOptions storyUi-inlineOptions__heading\">\r\n                                    <button class=\"storyUi-button\" ng-click=\"page.openEditor(page.data.headingDetails, $event);\" tooltips title=\"Edit font size, alignment and color\" tooltip-side=\"left\">\r\n                                        <span class=\"icon icon-font\"></span>\r\n                                    </button>\r\n                                    <!--<button class=\"storyUi-button\">-->\r\n                                    <!--<span class=\"icon icon-eyedropper\"></span>-->\r\n                                    <!--</button>-->\r\n                                </div>\r\n                                <h2 class=\"heading editable editableElem\" data-ph=\"Enter a heading\" contenteditable=\"true\" ng-model=\"page.data.headingDetails.text\" tabindex=\"1\" ng-style=\"page.setHeadingStyles();\"></h2>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"subHeadingContainer\">\r\n                            <h3 class=\"subHeading hide__editing\" ng-style=\"page.setSubheadingStyles();\">{{page.data.subheadingDetails.text}}</h3>\r\n                            <div class=\"inputWrapper show__editing\">\r\n                                <div class=\"storyUi-inlineOptions storyUi-inlineOptions__subheading\">\r\n                                    <button class=\"storyUi-button\" ng-click=\"page.openEditor(page.data.subheadingDetails, $event);\" tooltips title=\"Edit font size, alignment and color\" tooltip-side=\"left\">\r\n                                        <span class=\"icon icon-font\"></span>\r\n                                    </button>\r\n                                    <!--<button class=\"storyUi-button\">-->\r\n                                    <!--<span class=\"icon icon-eyedropper\"></span>-->\r\n                                    <!--</button>-->\r\n                                </div>\r\n                                <h3 class=\"subHeading editable editableElem\" data-ph=\"Enter a subheading\" contenteditable=\"true\" ng-model=\"page.data.subheadingDetails.text\" tabindex=\"2\" ng-style=\"page.setSubheadingStyles();\"></h3>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"descriptionContainer\">\r\n                            <p class=\"description hide__editing\" ng-style=\"page.setDescriptionStyles();\">\r\n                                {{page.data.descriptionDetails.text}}\r\n                            </p>\r\n                            <div class=\"inputWrapper show__editing\">\r\n                                <div class=\"storyUi-inlineOptions storyUi-inlineOptions__description\">\r\n                                    <button class=\"storyUi-button\" ng-click=\"page.openEditor(page.data.descriptionDetails, $event);\" tooltips title=\"Edit font size, alignment and color\" tooltip-side=\"left\">\r\n                                        <span class=\"icon icon-font\"></span>\r\n                                    </button>\r\n                                    <!--<button class=\"storyUi-button\">-->\r\n                                    <!--<span class=\"icon icon-eyedropper\"></span>-->\r\n                                    <!--</button>-->\r\n                                </div>\r\n                                <p class=\"description editable editableElem\" data-ph=\"Enter text\" contenteditable=\"true\" ng-model=\"page.data.descriptionDetails.text\" tabindex=\"3\" ng-style=\"page.setDescriptionStyles();\"></p>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"editControls show__editing\">\r\n                            <div class=\"storyText-slider slider__left\"></div>\r\n                            <div class=\"storyText-slider slider__top\"></div>\r\n                            <div class=\"storyText-slider slider__right\"></div>\r\n                            <div class=\"storyText-slider slider__bottom\"></div>\r\n                            <div class=\"storyText-corner corner__topLeft\"></div>\r\n                            <div class=\"storyText-corner corner__topRight\"></div>\r\n                            <div class=\"storyText-corner corner__bottomLeft\"></div>\r\n                            <div class=\"storyText-corner corner__bottomRight\"></div>\r\n                        </div>\r\n                        <div class=\"storyUi-positionControls show__editing\">\r\n                            <button class=\"storyUi-positionButton direction__left\" ng-click=\"page.changeDirection(\'left\', \'horizontal\');\">\r\n                                <span class=\"icon icon-left-big\"></span>\r\n                            </button>\r\n                            <button class=\"storyUi-positionButton direction__right\" ng-click=\"page.changeDirection(\'right\', \'horizontal\');\">\r\n                                <span class=\"icon icon-right-big\"></span>\r\n                            </button>\r\n                            <button class=\"storyUi-positionButton direction__up\" ng-click=\"page.changeDirection(\'top\', \'vertical\');\">\r\n                                <span class=\"icon icon-up-big\"></span>\r\n                            </button>\r\n                            <button class=\"storyUi-positionButton direction__down\" ng-click=\"page.changeDirection(\'bottom\', \'vertical\');\">\r\n                                <span class=\"icon icon-down-big\"></span>\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </article>\r\n    <div class=\"show__editing\"> <!-- show__editing -->\r\n        <div class=\"pageTopOptions\">\r\n            <button class=\"deletePageButton button button__round\" ng-click=\"page.updateImageModal();\"> <!-- tooltips title=\"Delete this page\" tooltip-side=\"left\" tooltip-try=\"0\" -->\r\n                <span class=\"button-icon icon icon-picture\"></span>\r\n            </button>\r\n            <button class=\"deletePageButton button button__round\" ng-click=\"story.removePage($index, page)\"> <!-- tooltips title=\"Delete this page\" tooltip-side=\"left\" tooltip-try=\"0\" -->\r\n                <span class=\"button-icon icon icon-trash\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"addPage\">\r\n            <button class=\"button addPage-button\" tooltips title=\"Add Page\" ng-click=\"story.addPage($index)\">\r\n                <span class=\"button-icon icon icon-plus\"></span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>");
$templateCache.put("partials/_story.html","<story-element></story-element>");
$templateCache.put("partials/_storyPage.html","<!-- NOT IN USE -->\r\n<div class=\"storyPageWrapper\" data-ng-controller=\"PageCTRL as page\"> <!-- move back to article object -->\r\n	<article class=\"storyPage\" back-img=\"{{page.data.background_image_urls[0].original}}\" ng-style=\"page.setPageCSS();\">\r\n		<div class=\"storyContainer storyContainer__resizable size__default\" resizable resizable-config=\"page.resizableContainer.configuration\" ng-style=\"{ \'max-width\' : page.safeData.measurements.containerWidth }\">\r\n			<div class=\"storyContainer-slider storyContainer-slider--left\"></div>\r\n			<div class=\"storyContainer-slider storyContainer-slider--right\"></div>\r\n			<div class=\"storyPadding padding__default\">\r\n				<div class=\"storyContent storyContent__resizable\" resizable resizable-config=\"page.resizableContent.configuration\" ng-style=\"page.setContentCSS();\">\r\n					<div ng-repeat=\"elementGroup in page.safeData.measurements.element_groups\" class=\"storyText storyText__resizable\" resizable resizable-config=\"page.resizableText.configuration\" position-vertical=\"page.data.measurements.positionVertical\" position-horizontal=\"page.data.measurements.positionHorizontal\" ng-class=\"page.setPositionClasses();\" ng-style=\"page.setTextDimensions();\">\r\n						<div ng-repeat=\"element in elementGroup.elements\" class=\"headingContainer\">\r\n							<h2 class=\"heading hide__editing\" ng-style=\"page.setElementStyles(element);\">{{element.text}}</h2>\r\n							<div class=\"inputWrapper show__editing\">\r\n								<div class=\"storyUi-inlineOptions storyUi-inlineOptions__heading\">\r\n									<button class=\"storyUi-button\" ng-click=\"page.openEditor(element, $event);\" tooltips title=\"Edit font size, alignment and color\" tooltip-side=\"left\">\r\n										<span class=\"icon icon-font\"></span>\r\n									</button>\r\n									<!--<button class=\"storyUi-button\">-->\r\n										<!--<span class=\"icon icon-eyedropper\"></span>-->\r\n									<!--</button>-->\r\n								</div>\r\n								<h2 ng-model=\"element.text\" ng-change=\"page.elementUpdated();\" class=\"heading editable editableElem\" data-ph=\"Enter a heading\" contenteditable=\"true\" tabindex=\"1\" ng-style=\"page.setElementStyles(element);\"></h2>\r\n							</div>\r\n						</div>\r\n						<div class=\"editControls show__editing\">\r\n							<div class=\"storyText-slider slider__left\"></div>\r\n							<div class=\"storyText-slider slider__top\"></div>\r\n							<div class=\"storyText-slider slider__right\"></div>\r\n							<div class=\"storyText-slider slider__bottom\"></div>\r\n							<div class=\"storyText-corner corner__topLeft\"></div>\r\n							<div class=\"storyText-corner corner__topRight\"></div>\r\n							<div class=\"storyText-corner corner__bottomLeft\"></div>\r\n							<div class=\"storyText-corner corner__bottomRight\"></div>\r\n						</div>\r\n						<div class=\"storyUi-positionControls show__editing\">\r\n							<button class=\"storyUi-positionButton direction__left\" ng-click=\"page.changeDirection(\'left\', \'horizontal\');\">\r\n								<span class=\"icon icon-left-big\"></span>\r\n							</button>\r\n							<button class=\"storyUi-positionButton direction__right\" ng-click=\"page.changeDirection(\'right\', \'horizontal\');\">\r\n								<span class=\"icon icon-right-big\"></span>\r\n							</button>\r\n							<button class=\"storyUi-positionButton direction__up\" ng-click=\"page.changeDirection(\'top\', \'vertical\');\">\r\n								<span class=\"icon icon-up-big\"></span>\r\n							</button>\r\n							<button class=\"storyUi-positionButton direction__down\" ng-click=\"page.changeDirection(\'bottom\', \'vertical\');\">\r\n								<span class=\"icon icon-down-big\"></span>\r\n							</button>\r\n						</div>\r\n					</div>\r\n				</div>\r\n			</div>\r\n		</div>\r\n	</article>\r\n	<div class=\"show__editing\"> <!-- show__editing -->\r\n		<div class=\"pageTopOptions\">\r\n			<button class=\"deletePageButton button button__round\" ng-click=\"page.updateImageModal();\"> <!-- tooltips title=\"Delete this page\" tooltip-side=\"left\" tooltip-try=\"0\" -->\r\n				<span class=\"button-icon icon icon-picture\"></span>\r\n			</button>\r\n			<button class=\"deletePageButton button button__round\" ng-click=\"story.removePage($index, page)\"> <!-- tooltips title=\"Delete this page\" tooltip-side=\"left\" tooltip-try=\"0\" -->\r\n				<span class=\"button-icon icon icon-trash\"></span>\r\n			</button>\r\n		</div>\r\n		<div class=\"addPage\">\r\n			<button class=\"button addPage-button\" tooltips title=\"Add Page\" ng-click=\"story.addPage($index)\">\r\n				<span class=\"button-icon icon icon-plus\"></span>\r\n			</button>\r\n		</div>\r\n	</div>\r\n</div>");
$templateCache.put("partials/_testing.html","<section>\r\n    <story-element></story-element>\r\n</section>");
$templateCache.put("partials/_textEditor.html","<div class=\"textEditor\" ng-controller=\"TextEditor as textEditor\" off-click=\"textEditor.hide();\" off-click-if=\"textEditor.states.open\" off-click-filter=\"\'.storyUi-button\'\"> <!--  drag-me=\"\" add .show__editing -->\r\n	<div class=\"handle handle__n\"></div>\r\n	<div class=\"handle handle__e\"></div>\r\n	<div class=\"handle handle__s\"></div>\r\n	<div class=\"handle handle__w\"></div>\r\n	<div class=\"padding __noDrag\">\r\n		<div class=\"content\">\r\n		<button class=\"button button__close icon icon-cancel\" ng-click=\"textEditor.hide();\"></button>\r\n		<section class=\"inputSection\">\r\n			<label class=\"label__plain\">Colour</label>\r\n			<div class=\"inputWrapper\">\r\n				<input type=\"text\" class=\"input__plain\" ng-model=\"textEditor.data.styles.color\" readonly/>\r\n			</div>\r\n			<color-picker ng-model=\"textEditor.data.styles.color\"></color-picker>\r\n		</section>\r\n		<section class=\"inputSection\" ng-class=\"{ \'state__dropdown\' : textEditor.states.dropdown_fontSize }\">\r\n			<label class=\"label__plain\" for=\"textEditor-fontSize\">Font-size</label>\r\n			<div class=\"input__dropdown inputWrapper\">\r\n				<input class=\"input__plain\" id=\"textEditor-fontSize\" type=\"text\"\r\n					   ng-model=\"textEditor.data.styles.fontSize\" readonly\r\n					   ng-click=\"textEditor.toggleDropdownFont();\" />\r\n				<span class=\"icon icon-down-dir\" ng-click=\"textEditor.toggleDropdownFont();\"></span>\r\n				<ul class=\"dropdown dropdown__input\">\r\n					<li ng-repeat=\"option in textEditor.options.fontSize\" ng-click=\"textEditor.selectOption(option,\r\n					\'fontSize\', \'dropdown_fontSize\')\">\r\n						{{ ::option }}\r\n					</li>\r\n				</ul>\r\n			</div>\r\n		</section>\r\n		<section class=\"inputSection\" ng-class=\"{ \'state__dropdown\' : textEditor.states.dropdown_textAlign }\"> <!-- state__dropdown -->\r\n			<label class=\"label__plain\" for=\"textEditor-alignment\">Text-align</label>\r\n			<div class=\"input__dropdown inputWrapper\">\r\n				<input class=\"input__plain\" id=\"textEditor-alignment\" type=\"text\"\r\n					   ng-model=\"textEditor.data.styles.textAlign\" readonly\r\n					   ng-click=\"textEditor.toggleDropdownAlign();\" />\r\n				<span class=\"icon icon-down-dir\" ng-click=\"textEditor.toggleDropdownAlign();\"></span>\r\n				<ul class=\"dropdown dropdown__input\">\r\n					<li ng-repeat=\"option in textEditor.options.textAlign\" ng-click=\"textEditor.selectOption(option,\r\n					\'textAlign\', \'dropdown_textAlign\')\">\r\n						{{ ::option }}\r\n					</li>\r\n				</ul>\r\n			</div>\r\n		</section>\r\n	</div>\r\n	</div>\r\n</div>");
$templateCache.put("partials/_textMenu.html","<div class=\"textMenu\" ng-controller=\"TextEditor as textEditor\">\r\n    <div class=\"textMenuCentre clearfix\">\r\n        <section class=\"textMenu-section\">\r\n            <div class=\"labelInput\">\r\n                <label class=\"label__plain\" for=\"\">Font-size</label>\r\n            </div>\r\n            <div class=\"fontSizeOptions clearfix\">\r\n                <button class=\"buttonMinus button__plain\">-</button>\r\n                <button class=\"buttonPlus button__plain\">+</button>\r\n                <div class=\"inputWrapper\">\r\n                    <input ng-model=\"textEditor.data.fontSize\" class=\"mainInput input__plain\" type=\"text\" readonly/>\r\n                </div>\r\n            </div>\r\n        </section>\r\n        <section class=\"textMenu-section\">\r\n            <div class=\"labelInput\">\r\n                <label class=\"label__plain\" for=\"\">Text-align</label>\r\n                <!--<input ng-model=\"textEditor.data.textAlign\" class=\"mainInput input__plain\" type=\"text\" readonly/>-->\r\n            </div>\r\n            <div class=\"clearfix inlineButtons\">\r\n                <button class=\"button__plain\" ng-class=\"{ \'state__selected\' : textEditor.data.textAlign == \'left\' }\">left</button>\r\n                <button class=\"button__plain\" ng-class=\"{ \'state__selected\' : textEditor.data.textAlign == \'center\' }\">center</button>\r\n                <button class=\"button__plain\" ng-class=\"{ \'state__selected\' : textEditor.data.textAlign == \'right\' }\">right</button>\r\n            </div>\r\n        </section>\r\n        <section class=\"textMenu-section\">\r\n            <div class=\"labelInput\">\r\n                <label class=\"label__plain\">Colour</label>\r\n            </div>\r\n            <div class=\"fontColorOptions clearfix\">\r\n                <div class=\"colorPreview\">c</div>\r\n                <button class=\"buttonColor button__plain\">i</button>\r\n                <div class=\"inputWrapper\">\r\n                    <input type=\"text\" class=\"mainInput input__plain\" ng-model=\"textEditor.data.color\" readonly/>\r\n                </div>\r\n            </div>\r\n            <!--<color-picker ng-model=\"textEditor.data.color\"></color-picker>-->\r\n        </section>\r\n    </div>\r\n</div>");
$templateCache.put("partials/account/_signIn.html","<form class=\"modal modal--rounded modal--bigAction\"\r\n        ng-class=\"{\r\n            \'state__busy\' : modalVM.states.busy,\r\n            \'state__error\' : modalVM.states.error }\"\r\n        name=\"SignInForm\"\r\n        ng-submit=\"modalVM.submit(SignInForm.$valid)\" novalidate>\r\n    <div class=\"modal__body form--light\">\r\n        <h3 class=\"modal__title title--default\">Sign into Yep.is</h3>\r\n        <div class=\"form__section\">\r\n            <label class=\"labelAndInput\">\r\n                <div>\r\n                    <input ng-model=\"modalVM.input.username\"\r\n                           placeholder=\"Username\"\r\n                           type=\"text\" required/>\r\n                </div>\r\n            </label>\r\n        </div>\r\n        <div class=\"form__section\">\r\n            <label class=\"labelAndInput\">\r\n                <div>\r\n                    <input ng-model=\"modalVM.input.password\"\r\n                           placeholder=\"Password\"\r\n                           type=\"password\" required/>\r\n                </div>\r\n            </label>\r\n        </div>\r\n        <div class=\"form__section\">\r\n            <a ng-click=\"modalVM.changeModal();\" class=\"link--small\">Don\'t have an account?</a>\r\n        </div>\r\n        <div class=\"form__section show__error\">\r\n            <p class=\"msg--error\">Unable to sign in. Check your username and password and try again.</p>\r\n        </div>\r\n    </div>\r\n    <div class=\"modal__bottom\">\r\n        <button ng-click=\"modalVM.submit();\"\r\n                class=\"submitButton button--fullAction\"\r\n                type=\"submit\">\r\n            <span class=\"hide__busy\">Sign In</span>\r\n            <span class=\"show__busy __inline\">Signing In <span class=\"loader loader--miniBlue\"></span></span>\r\n        </button>\r\n    </div>\r\n</form>");
$templateCache.put("partials/account/_signUp.html","<form class=\"modal modal--rounded modal--bigAction\"\r\n      ng-class=\"{\r\n            \'state__busy\' : modalVM.states.busy,\r\n            \'state__error\' : modalVM.states.error }\"\r\n      name=\"SignUpForm\"\r\n      ng-submit=\"modalVM.submit(SignUpForm.$valid)\" novalidate>\r\n    <div class=\"modal__body form--light\">\r\n        <h3 class=\"modal__title title--default\">Register for Yep.is</h3>\r\n        <div class=\"form__section\">\r\n            <label class=\"labelAndInput\">\r\n                <div>\r\n                    <input ng-model=\"modalVM.input.username\"\r\n                           placeholder=\"Username\"\r\n                           type=\"text\" required/>\r\n                </div>\r\n            </label>\r\n        </div>\r\n        <div class=\"form__section\">\r\n            <label class=\"labelAndInput\">\r\n                <div>\r\n                    <input ng-model=\"modalVM.input.email\"\r\n                           placeholder=\"Email\"\r\n                           type=\"email\" required/>\r\n                </div>\r\n            </label>\r\n        </div>\r\n        <div class=\"form__section\">\r\n            <label class=\"labelAndInput\">\r\n                <div>\r\n                    <input ng-model=\"modalVM.input.password\"\r\n                           placeholder=\"Password\"\r\n                           type=\"password\" required/>\r\n                </div>\r\n            </label>\r\n        </div>\r\n        <div class=\"form__section\">\r\n            <a ng-click=\"modalVM.changeModal();\" class=\"link--small\">Already have an account?</a>\r\n        </div>\r\n        <div class=\"form__section show__error\">\r\n            <p class=\"msg--error\">Failed to register. Check your details and try again.</p>\r\n        </div>\r\n    </div>\r\n    <div class=\"modal__bottom\">\r\n        <button class=\"submitButton button--fullAction\"\r\n                type=\"submit\">\r\n            <span class=\"hide__busy\">Register</span>\r\n            <span class=\"show__busy __inline\">Registering <span class=\"loader loader--miniBlue\"></span></span>\r\n        </button>\r\n    </div>\r\n</form>");
$templateCache.put("partials/story/_createStory.html","<form class=\"modal modal--wideAction modal--rounded\"\r\n      ng-class=\"{ \'state__busy\' : modalVM.states.busy }\"\r\n      ng-submit=\"modalVM.submit();\" novalidate>\r\n    <h3 class=\"modal__title title--default\">Create a Story</h3>\r\n    <div class=\"modal__body form--createStory form--light clearfix\">\r\n        <section class=\"createStory__inputs\">\r\n            <div class=\"form__section\">\r\n                <label class=\"labelAndInput\">\r\n                    <div>\r\n                        <input ng-model=\"modalVM.input.title\"\r\n                               placeholder=\"Story Title\"\r\n                               type=\"text\" required/>\r\n                    </div>\r\n                </label>\r\n            </div>\r\n            <div class=\"form__section\">\r\n                <label class=\"labelAndInput\">\r\n                    <div>\r\n                        <textarea ng-model=\"modalVM.input.description\"\r\n                               placeholder=\"Description\"\r\n                               required></textarea>\r\n                    </div>\r\n                </label>\r\n            </div>\r\n        </section>\r\n        <section class=\"createStory__preview\"\r\n                 ng-class=\"{ \'state__processing\' : modalVM.states.image.processing,\r\n                 \'state__uploading\' : modalVM.states.image.uploading,\r\n                  \'state__prepping\' : modalVM.states.image.prepping}\">\r\n            <article class=\"createStoryCard\">\r\n                <figure class=\"image\" back-img=\"{{modalVM.input.imageObj.thumbnail}}\">\r\n                    <button class=\"button button--medium\"\r\n                            ngf-select=\"modalVM.uploadImage($file);\">\r\n                        <span ng-hide=\"modalVM.states.image.busy\">Upload a Preview Image</span>\r\n                        <span class=\"show__prepping\">\r\n                            Preparing... <span class=\"loader loader--miniBlue\"></span>\r\n                        </span><span class=\"show__processing\">\r\n                            Processing... <span class=\"loader loader--miniBlue\"></span>\r\n                        </span>\r\n                        <span class=\"show__uploading\">\r\n                            Uploading <span ng-bind=\"modalVM.states.image.uploadProgress\"></span>%\r\n                        </span>\r\n                    </button>\r\n                </figure>\r\n                <p class=\"title\" ng-bind=\"modalVM.input.title\"></p>\r\n            </article>\r\n        </section>\r\n    </div>\r\n    <section class=\"modal__bottom\">\r\n        <button class=\"btn btn--create btn__simple\"\r\n                ng-class=\"{ \'state__disabled\' : !modalVM.isValidForm() }\"\r\n                type=\"submit\">\r\n            <span class=\"hide__busy\">Create Story</span>\r\n            <span class=\"show__busy\">Creating Story <span class=\"loader loader--miniGreen __down\"></span></span>\r\n        </button>\r\n    </section>\r\n</form>");
$templateCache.put("partials/story/_deletePage.html","<section class=\"modal modal--rounded modal--confirm\"\r\n         ng-class=\"{ \'state__busy\' : modalVM.states.busy }\">\r\n    <h3 class=\"title--default\">Delete Page</h3>\r\n    <h4 class=\"title--default\">This is permanent and can\'t be undone.</h4>\r\n    <div class=\"modal__body\">\r\n        <button class=\"btn btn__simple __plain\" ng-click=\"closeThisDialog();\">Cancel</button>\r\n        <button class=\"btn btn__simple __warning\" ng-click=\"modalVM.confirm();\">\r\n            <span class=\"hide__busy\">Delete</span>\r\n            <span class=\"show__busy\">Deleting...</span>\r\n        </button>\r\n    </div>\r\n</section>");
$templateCache.put("partials/story/_deleteStory.html","<section class=\"modal modal--rounded modal--confirm\"\r\n         ng-class=\"{ \'state__busy\' : modalVM.states.busy }\">\r\n    <h3 class=\"title--default\">Delete <span ng-bind=\"modalVM.story.title\"></span></h3>\r\n    <h4 class=\"title--default\">This is permanent and can\'t be undone.</h4>\r\n    <div class=\"modal__body\">\r\n        <button class=\"btn btn__simple __plain\" ng-click=\"closeThisDialog();\">Cancel</button>\r\n        <button class=\"btn btn__simple __warning\" ng-click=\"modalVM.confirm();\">\r\n            <span class=\"hide__busy\">Delete</span>\r\n            <span class=\"show__busy\">Deleting...</span>\r\n        </button>\r\n    </div>\r\n</section>");
$templateCache.put("partials/story/_story.html","<article class=\"story\"\r\n         ng-class=\"{ \'state__loading\' : story.states.loading,\r\n         \'state__owner\' : story.states.owner,\r\n         \'state__editing\' : story.states.editing,\r\n         \'state__emptyStory\' : !story.states.loading && story.data.story.pages.length == 0,\r\n         \'state__deleted\' : story.states.deleted }\">\r\n    <story-menu\r\n            ng-show=\"!story.states.loading && story.states.owner && !story.states.deleted\"></story-menu>\r\n    <text-editor ng-if=\"story.states.textEditorOpen\"\r\n                 drag-me=\"\"\r\n                 drag-options=\"{{story.editorOptions}}\"\r\n                 visible=\"story.states.textEditorOpen\"\r\n                 offset=\"story.editingOffset\"\r\n                 pending=\"story.editingPagePending\"\r\n                 editing-element=\"story.editingElement\"></text-editor>\r\n    <section class=\"show__loading\">\r\n        <div class=\"flex__wrapper __positionAbsolute\">\r\n            <ul class=\"loadingDots\">\r\n                <li></li>\r\n                <li></li>\r\n                <li></li>\r\n            </ul>\r\n        </div>\r\n    </section>\r\n    <div class=\"story__pages\">\r\n        <story-page ng-controller=\"StoryPageCTRL as pageVM\"\r\n                    ng-repeat=\"page in story.data.story.pages\"></story-page>\r\n    </div>\r\n    <section class=\"story__empty show__deleted\">\r\n        <div class=\"__maxSize\">\r\n            <h3>This story has been deleted</h3>\r\n        </div>\r\n    </section>\r\n    <section class=\"story__empty show__emptyStory\">\r\n        <div class=\"__maxSize show__owner align__center\">\r\n            <h3>Add a Page</h3>\r\n            <button ng-click=\"story.addPage(0);\" class=\"button button--round __hover--cool\">\r\n                <span class=\"icon icon-plus\"></span>\r\n            </button>\r\n        </div>\r\n        <div class=\"__maxSize hide__owner\">\r\n            <h3>This story is empty</h3>\r\n            <h4>The owner hasn\'t added any content yet.</h4>\r\n        </div>\r\n    </section>\r\n    <footer class=\"story__footer hide__loading\">\r\n        <div class=\"__maxSize\">\r\n            <h4>\r\n                <a href=\"#/\">yep.is</a>\r\n            </h4>\r\n        </div>\r\n    </footer>\r\n</article>");
$templateCache.put("partials/story/_storyElement.html","<div class=\"story__element\">\r\n    <div class=\"element__options show__editing\">\r\n        <button ng-click=\"elementVM.editElement($event);\"\r\n                class=\"storyUi__button option button button--round __mini __hover--cool\">\r\n            <span class=\"icon icon-font\"></span>\r\n        </button>\r\n    </div>\r\n    <p class=\"hide__editing\" ng-style=\"elementVM.setStyles();\"\r\n       contenteditable=\"false\"\r\n       ng-model=\"elementVM.element.text\"\r\n       strip-br=\"false\"\r\n       strip-tags=\"true\"></p>\r\n    <p class=\"show__editing element--editable\" ng-style=\"elementVM.setStyles();\"\r\n       contenteditable=\"true\"\r\n       ng-model=\"elementVM.element.text\"\r\n       strip-br=\"false\"\r\n       strip-tags=\"true\"></p>\r\n</div>");
$templateCache.put("partials/story/_storyMenu.html","<aside class=\"story__menu\">\r\n    <a class=\"title\"\r\n       ng-href=\"#/s/{{::story.data.story.id}}/{{::story.data.story.title | slugify}}\"\r\n       ng-bind=\"::story.data.story.title\"></a>\r\n    <ul class=\"options\">\r\n        <li>\r\n            <button ng-click=\"story.deleteStoryPrompt();\" class=\"option button button--listed\">\r\n                <span class=\"icon icon-trash\"></span>\r\n                <span class=\"text\">Delete Story</span>\r\n            </button>\r\n        </li>\r\n        <li>\r\n            <button ng-click=\"story.toggleEditing();\" class=\"option button button--listed\">\r\n                <span class=\"icon icon-pencil\"></span>\r\n                <span class=\"text\">Toggle Editing</span>\r\n            </button>\r\n        </li>\r\n    </ul>\r\n</aside>");
$templateCache.put("partials/story/_storyPage.html","<article class=\"story-page\"\r\n         ng-class=\"{ \'state__deleted\' : pageVM.page.deleted,\r\n         \'state__updating\' : pageVM.states.updating }\">\r\n    <page-options ng-if=\"::story.states.owner\" class=\"show__editing\"></page-options>\r\n    <div class=\"story-page-img\" back-img=\"{{pageVM.page.background_image_urls[0].original}}\">\r\n        <div class=\"story-page-width\"\r\n             config=\"pageVM.widthConfig\"\r\n             owner=\"story.states.owner\"\r\n             editing=\"story.states.editing\"\r\n             page-width=\"pageVM.page.measurements_prepped.container_width\">\r\n            <div class=\"page__width__slider __left\"></div>\r\n            <div class=\"page__width__slider __right\"></div>\r\n            <div class=\"story-page-container\"\r\n                 page-offsets\r\n                 config=\"pageVM.offsetsConfig\"\r\n                 owner=\"story.states.owner\"\r\n                 editing=\"story.states.editing\"\r\n                 page-vertical=\"pageVM.page.measurements_prepped.vertical_offset\"\r\n                 page-horizontal=\"pageVM.page.measurements_prepped.horizontal_offset\">\r\n                <story-text\r\n                        measurements=\"pageVM.page.measurements_prepped\"\r\n                        config=\"pageVM.textConfig\"\r\n                        owner=\"story.states.owner\"\r\n                        editing=\"story.states.editing\"\r\n                        vertical=\"pageVM.page.measurements_prepped.text_vertical\"\r\n                        horizontal=\"pageVM.page.measurements_prepped.text_horizontal\"\r\n                        elements=\"pageVM.page.elements_prepped\"\r\n                        pending=\"pageVM.pendingChanges\"\r\n                        edit-element=\"story.editElement\">\r\n                </story-text>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div ng-if=\"::story.states.owner\" class=\"story-page-bottom\">\r\n        <button ng-click=\"story.addPage($index);\" class=\"button button--round __hover--cool\">\r\n            <span class=\"icon icon-plus\"></span>\r\n        </button>\r\n    </div>\r\n</article>");
$templateCache.put("partials/story/_storyPageOptions.html","<aside class=\"storyPage__options\">\r\n    <button ng-click=\"pageVM.changeImage();\"\r\n            class=\"option button button--round __hover--cool\">\r\n        <span class=\"icon icon-picture\"></span>\r\n    </button>\r\n    <button ng-click=\"pageVM.deletePage($index);\"\r\n            class=\"option button button--round __hover--warning\">\r\n        <span class=\"icon icon-trash\"></span>\r\n    </button>\r\n    <button ng-click=\"pageVM.savePage();\"\r\n            ng-class=\"{\r\n                \'state__active\' : pageVM.states.pendingChanges,\r\n                \'state__busy\' : pageVM.states.updating\r\n            }\"\r\n            class=\"option button button--round\">\r\n        <span class=\"icon icon-floppy hide__busy\"></span>\r\n        <span class=\"loader loader--miniBlue show__busy __inline\"></span>\r\n    </button>\r\n</aside>");
$templateCache.put("partials/story/_storyPreview.html","<article class=\"storyPreviewCard\">\r\n    <div class=\"storyPreviewCard-img\" back-img=\"{{story.profile_image_urls[0].medium}}\">\r\n        <a class=\"hide__placeholder\" ng-href=\"#/s/{{::story.id}}/{{::story.title | slugify}}\"></a>\r\n        <div class=\"flex__wrapper show__placeholder __flex\">\r\n            <ul class=\"loadingDots\">\r\n                <li></li>\r\n                <li></li>\r\n                <li></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n    <div class=\"storyPreviewCard-info\">\r\n        <a class=\"storyPreviewCard-title\"\r\n           ng-href=\"#/s/{{::story.id}}/{{::story.title | slugify}}\"\r\n           ng-bind=\"::story.title\"></a>\r\n    </div>\r\n</article>");
$templateCache.put("partials/story/_storyText.html","<section class=\"story-page-text\">\r\n    <story-element editing=\"editing\"\r\n                   element=\"element\"\r\n                   pending=\"pending\"\r\n                   edit-element=\"editElement\"\r\n                   ng-repeat=\"element in elements track by $index\"></story-element>\r\n    <div class=\"page__text__positionControls show__editing\">\r\n        <button ng-click=\"moveText(\'top\', \'v\')\"\r\n                class=\"direction__button button button--round __hover--cool direction__up\">\r\n            <span class=\"icon icon-up-big\"></span>\r\n        </button>\r\n        <button ng-click=\"moveText(\'bottom\', \'v\')\"\r\n                class=\"direction__button button button--round __hover--cool direction__down\">\r\n            <span class=\"icon icon-down-big\"></span>\r\n        </button>\r\n        <button ng-click=\"moveText(\'left\', \'h\')\"\r\n                class=\"direction__button button button--round __hover--cool direction__left\">\r\n            <span class=\"icon icon-left-big\"></span>\r\n        </button>\r\n        <button ng-click=\"moveText(\'right\', \'h\')\"\r\n                class=\"direction__button button button--round __hover--cool direction__right\">\r\n            <span class=\"icon icon-right-big\"></span>\r\n        </button>\r\n    </div>\r\n</section>");
$templateCache.put("partials/story/_storyTextEditor.html","<div class=\"textEditor\" off-click=\"textEditor.hide();\" off-click-if=\"visible\" off-click-filter=\"\'.storyUi__button\'\">\r\n    <div class=\"handle handle__n\"></div>\r\n    <div class=\"handle handle__e\"></div>\r\n    <div class=\"handle handle__s\"></div>\r\n    <div class=\"handle handle__w\"></div>\r\n    <div class=\"padding __noDrag\">\r\n        <div class=\"content\">\r\n            <button class=\"button button__close icon icon-cancel\" ng-click=\"textEditor.hide();\"></button>\r\n            <section class=\"inputSection\">\r\n                <label class=\"label__plain\">Colour</label>\r\n                <div class=\"inputWrapper\">\r\n                    <input type=\"text\" class=\"input__plain\" ng-model=\"textEditor.element.color\" readonly/>\r\n                </div>\r\n                <color-picker ng-model=\"textEditor.element.color\"></color-picker>\r\n            </section>\r\n            <section class=\"inputSection\" ng-class=\"{ \'state__dropdown\' : textEditor.states.dropdown_fontSize }\">\r\n                <label class=\"label__plain\" for=\"textEditor-fontSize\">Font-size</label>\r\n                <div class=\"input__dropdown inputWrapper\">\r\n                    <input class=\"input__plain\" id=\"textEditor-fontSize\" type=\"text\"\r\n                           ng-model=\"textEditor.element.font_size\" readonly\r\n                           ng-click=\"textEditor.toggleDropdownFont();\" />\r\n                    <span class=\"icon icon-down-dir\" ng-click=\"textEditor.toggleDropdownFont();\"></span>\r\n                    <ul class=\"dropdown dropdown__input\">\r\n                        <li ng-repeat=\"option in textEditor.options.fontSize\" ng-click=\"textEditor.selectOption(option,\r\n					\'font_size\', \'dropdown_fontSize\')\">\r\n                            {{ ::option }}\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </section>\r\n            <section class=\"inputSection\" ng-class=\"{ \'state__dropdown\' : textEditor.states.dropdown_textAlign }\"> <!-- state__dropdown -->\r\n                <label class=\"label__plain\" for=\"textEditor-alignment\">Text-align</label>\r\n                <div class=\"input__dropdown inputWrapper\">\r\n                    <input class=\"input__plain\" id=\"textEditor-alignment\" type=\"text\"\r\n                           ng-model=\"textEditor.element.text_align\" readonly\r\n                           ng-click=\"textEditor.toggleDropdownAlign();\" />\r\n                    <span class=\"icon icon-down-dir\" ng-click=\"textEditor.toggleDropdownAlign();\"></span>\r\n                    <ul class=\"dropdown dropdown__input\">\r\n                        <li ng-repeat=\"option in textEditor.options.textAlign\" ng-click=\"textEditor.selectOption(option,\r\n					\'text_align\', \'dropdown_textAlign\')\">\r\n                            {{ ::option }}\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </section>\r\n        </div>\r\n    </div>\r\n</div>");
$templateCache.put("partials/image/_uploadImage.html","<section class=\"modal modal--rounded modal--confirm\"\r\n         ng-class=\"{ \'state__busy\' : modalVM.states.busy,\r\n          \'state__error\' : modalVM.states.error,\r\n          \'state__prepping\' : modalVM.states.prepping,\r\n          \'state__processing\' : modalVM.states.processing,\r\n          \'state__uploading\' : modalVM.states.uploading\r\n          }\">\r\n    <h3 class=\"title--default\">Upload an Image</h3>\r\n    <div class=\"modal__body\">\r\n        <figure back-img=\"{{modalVM.image.original}}\"\r\n                class=\"bgImagePreview flex--centered\"\r\n                ngf-select=\"modalVM.uploadImage($file);\">\r\n            <button class=\"button button--medium\">\r\n                <span ng-hide=\"modalVM.states.busy\">Upload an Image</span>\r\n                        <span class=\"show__prepping\">\r\n                            Preparing... <span class=\"loader loader--miniBlue\"></span>\r\n                        </span><span class=\"show__processing\">\r\n                            Processing... <span class=\"loader loader--miniBlue\"></span>\r\n                        </span>\r\n                        <span class=\"show__uploading\">\r\n                            Uploading <span ng-bind=\"modalVM.states.uploadProgress\"></span>%\r\n                        </span>\r\n            </button>\r\n        </figure>\r\n        <div class=\"modal__majorButtons\">\r\n            <button class=\"btn btn__simple __plain\" ng-click=\"closeThisDialog();\">Cancel</button>\r\n            <button class=\"btn btn__simple __warning\" ng-click=\"modalVM.confirm();\">\r\n                <span>Save</span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n</section>");}]);